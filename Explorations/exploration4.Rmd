
---
```{r}
download.file("http://jakebowers.org/Data/ANES/anes_pilot_2016_csv.zip",destfile="anespilot2016.csv.zip")
unzip("anespilot2016.csv.zip")
anespi16<-read.csv("anes_pilot_2016.csv",as.is=TRUE,strip.white=TRUE)
```


```{r}
table(anespi16$fttrump,useNA="ifany")
table(anespi16$birthyr,useNA="ifany")

anespi16$fttrump[anespi16$fttrump==998]<-NA
anespi16$age <- 2016-anespi16$birthyr

summary(anespi16$age)
summary(anespi16$fttrump)
summary(anespi16$lcself)
anespi16$libcon <- ifelse(anespi16$lcself==8,NA,anespi16$lcself)

res <- sapply(1:7,function(lc){
		      coef(lm(fttrump~age,data=anespi16,subset=libcon==lc))
	})
colnames(res) <- 1:7

library(MASS)
res2 <- sapply(1:7,function(lc){
		      coef(rlm(fttrump~age,data=anespi16,subset=libcon==lc))
	})
colnames(res2) <- 1:7
```


Our friend needs help with understanding the concept of 'causality.' First, we would like to explain to her the most rigorous way to define causality. Second, we would like to show her that there are many limitations to demonstrating a perfect causal relationship between variables. Last, we would like to use one of the alternative causal explanations that seem appropriate for explaining the given data. Furthermore, we would like to suggest which variable can best explain the feeling thermometer for Donald Trump.

First, causality is a term connecting the cause and the effect. It is used in the form of 'X caused Y' or 'Y occurred because of X'. We have seen from the article by Brady (Brady, H. E. (2008) Causation and explanation in social science, Oxford handbook of political methodology, 217-270) that there are several approaches to causality: Neo-Humean regularity, counterfactual, manipulation, and mechanisms and capacities. Brady presented the four approaches in a certain order where we can see the evolution of different perspectives on causality by observing the problem of one approach and how the other approach can solve it. However, we will start from the approach that we think is the most rigorous definition of causality and review the alternatives later, for the sake of eventually applying it to our given task. 

We believe that the concept of causality is best demonstrated in an approach where there is a mechanism explaining the link between two variables. It appeals to the operation of the "mechanism or capacity"" that leads from cause to the effect. For example, using the example from the article, recent studies have uncovered biological mechanisms that explain the link between smoking and lung cancer. If the action of smoking brought some harmful chemicals into the body that stimulated reactions from some organs and eventually created cancer cells at lungs, then we can say that this link is a strong evidence for causality between smoking and lung cancer.

However, there are many limitations for us to utilize the approach of mechanisms and capacities. First is that there is a difference between physical phenomena and social phenomena. Social phenomena deal with reasons, perceptions, beliefs, and attitudes that affect human behavior. It is true that these factors can and should be observed and measured. However, it is still true that demonstrating mechanisms and capacities, or 'hooks', is more difficult for social phenomena. There is also a problem of defining social concepts and deciding which factors to consider in explaining the correlation. One of the main constraints that we face would be the time factor; we cannot go back in time where we can duplicate mechanisms and capacities.

Instead, we can create a situation where we test what regularly produces the effect from the cause. This approach is called manipulation. This approach is widely used in experimental researches, where an environment is designed similar to the reality and researchers observe what happens by manipulating the causes. By focusing on establishing the direction of causation, scholars think that causation exists when there is a recipe that regularly produces effects from causes. This experimental setting is a good way to substitute reality, as long as it is designed carefully and as long as it is possible to do so. It is true that we cannot always conduct manipulation approach, or experimental research, because it requires many resources.

The next approach, counterfactual approach can be an alternative explanation. This is an approach using the concept of 'if X caused Y, then Y could not have occurred where there was no X.' For example, there is an example in the article: 'if Bismark had not gone to war, what would have happened to German and Italian unification.' It is a good way to show the effectiveness of the causality. However, there are two problems: the absence of direction and the two effects of a common cause being mistaken for cause and effect. First problem states the situation that when both x and y did not occur, it does not guarantee that y did not occur because x did not cause y. It could be the opposite; x did not occur because y did not occur. Second problem means that if x and y were the causes of z, it cannot be said that there was a causation between x and y (it is possible that another causality may exist between x and y).

The last approach of causality from the article is the Humean and Neo-Humean one. In particular, John Mackie proposed a set of conditions requiring that a cause be an insufficient[I] but necessary[N] part of a condition which is itself unnecessary[U] but exclusively sufficient[S] for the effect. This observes constant conjunction and correlation by focusing on how much a cause (independent variable) had effects on dependent variable.

Observing the four approaches to causality, we should make a decision on which approach we would like to use. This decision is dependent upon what is available to us and what the purpose of our research is. We have previously looked at the relationship between age and fttrump and tried to measure the effect of age upon fttrump. This is relatively close to Humean and Neo-Humean approach, in which we inferred the relationship between the two factors and used many models of regression to explain them. This time, we will try the counterfactual approach. One reason can be the fact that manipulation approach and mechanisms approach are not available in current situation as explained above. Nevertheless, another important reason is related to the purpose of our research, which is to interpret the survey data that we have. If the purpose is to really understand why people support Donald Trump, other approaches might give more detailed results. However, we believe that the counterfactual approach is sufficient to interpret the data, concerning that we already have some general understanding of the factors that might contribute to Trump support. 

Therefore, we would like to check whether the support for Trump can be explained if there was no change in either age, ideology, political knowledge, ethnicity, or American identity. We will consider situations where there is no variation within a particular variable. To do so, we subset the respondents who are similar to each other within the chosen variable, and show whether other variables still show certain relationship with fttrump.



According to our friend, different groups are arguing over which variable has more correlation with the support for Trump. One group asserts that ideology is more influential, while the other says that ideology is influential because it is related to age. The other group argues that ethnicity, including all the abovementioned variables is interactively affecting the support for Trump. To verify the friend's statement, it is important to figure out the actual relationship of a single variable on the dependent variable, while controlling other potential causes.

The 4 factors that we selected as the potential cause for trump support are ideology, knowledge, race, and American identity. As a measurement for each factor we have chosen the following variables from the anespi16 data. For ideology, we chose 'lcself' which is a 7 point scale with 1 being the most liberal and 7 the most conservative. The variable race is coded 1 for being white and the rest of the racial groups(2~8) as 0. The factor 'knowledge' measures how much the respondent is knowledgeable by asking "on which of the following does the U.S. federal government currently spend the least?" People who chose 1 as their answer is regarded to be knowedgeable. We have recoded this variable into a continuous variable by coding the incorrect answers(2,3,4) to 0. For our fourth variable, we chose American identity.We expect that people who have stronger American identity tend to be more conservative and thus support trump. This variable is measured on a 5 point scale, having the strongest identity coded as 1.

Since we have four variables, we run four linear regression, which shows the correlation between each predicter and reponse variables. By examing the coefficients of each regression result, we could see which variable best explains the support for trump compared to other variables.

Before running the regression, we have subsetted the variables that do not seem to support trump and used the same subsetted variables for each regression. We do this to make the coefficients of each variable comparable. The coefficients would be more comparable if we make the sample population being tested as similar as possible. We subset under the hypotheses that ideologically liberal people (lcself=1:3), non-white people  (race!=1), politically knowledgeable people (know==1), and people with weaker American identity (amer_ident=4:5) are less likely to support trump. Second, we subset the variable as a way of controlling other variables, and to eventually chose which variable is more related to explain the support for trump.

#Converting categorical variables to continuous variables
```{r}
library(car)
know <- recode(anespi16$pk_spend, "1=1;else=0") 
race1 <- recode (anespi16$race, "1=1;else=0")
```


#Regression for each variable after we subsetting the variables that do not seem to support trump
```{r}
lm(fttrump ~ lcself, data=anespi16, subset=race!=1&know==1&amer_ident%in%4:5)
lm(fttrump ~ race1, data=anespi16, subset=lcself==1:3&know==1&amer_ident%in%1:2)
lm(fttrump ~ know, data=anespi16, subset=race1!=1&lcself==1:3&amer_ident%in%1:2)
lm(fttrump ~ amer_ident, data=anespi16, subset=race1!=1&know==1&lcself==1:3)
```

#Plotting the data points used in the regression and plotting the resulting line on top of that
```{r}
lm_lcself <- lm(fttrump ~ lcself, data=anespi16, subset=race!=1&know==1&amer_ident%in%4:5)
summary(lm_lcself)
sum(lm_lcself$residuals^2)
require(dplyr)
with(anespi16, plot(age, fttrump))
with(filter(anespi16, race!=1, know==1, amer_ident%in%4:5), plot(age, fttrump))
abline(lm_lcself)
require(ggplot2)
ggplot(data = filter(anespi16, race!=1, know==1, amer_ident%in%1:2), aes(x=age, y=fttrump)) +  geom_point(pch=0.5) +  stat_smooth(method = "lm", se = F)
```


```{r}
lm_race1<-lm(fttrump ~ race1, data=anespi16, subset=lcself==1:3&know==1&amer_ident%in%4:5)
summary(lm_race1)
sum(lm_race1$residuals^2)
require(dplyr)
with(anespi16, plot(age, fttrump))
with(filter(anespi16, lcself%in%1:3, know==1, amer_ident%in%4:5), plot(age, fttrump))
abline(lm_race1)
require(ggplot2)
ggplot(data = filter(anespi16, lcself%in%1:3, know==1, amer_ident%in%4:5), aes(x=age, y=fttrump)) +  geom_point(pch=0.5) +  stat_smooth(method = "lm", se = F)
```

```{r}
lm_know<-lm(fttrump ~ know, data=anespi16, subset=lcself%in%1:3&race1!=1&amer_ident%in%4:5)
summary(lm_know)
sum(lm_know$residuals^2)
require(dplyr)
with(anespi16, plot(age, fttrump))
with(filter(anespi16, lcself%in%1:3, race1!=1, amer_ident%in%4:5), plot(age, fttrump))
abline(lm_know)
require(ggplot2)
ggplot(data = filter(anespi16, lcself%in%1:3, race1!=1, amer_ident%in%4:5), aes(x=age, y=fttrump)) +  geom_point(pch=0.5) +  stat_smooth(method = "lm", se = F)
```


```{r}
lm_amerident<-lm(fttrump ~ amer_ident, data=anespi16, subset=race1!=1&know==1&lcself==1:3)
summary(lm_amerident)
sum(lm_amerident$residuals^2)
require(dplyr)
with(anespi16, plot(age, fttrump))
with(filter(anespi16, lcself%in%1:3, race1!=1, know==1), plot(age, fttrump))
abline(lm_amerident)
require(ggplot2)
ggplot(data = filter(anespi16, lcself%in%1:3, race1!=1, know==1), aes(x=age, y=fttrump)) +  geom_point(pch=0.5) +  stat_smooth(method = "lm", se = F)
```

#Creating a table that shows the coefficients and the sum of squared residuals of each variable. 
```{r}
tbl <- matrix(c(8362, 2701, 3743, 4989, 5.148, 16.3, 14.38, -6.726,-0.04876, -0.0161, -0.07359, 0.07359, 0.4831, 0.382, 0.5532, 0.201), ncol=4, byrow=TRUE)
colnames(tbl) <- c("Ideology","Race", "Political Knowledge", "American Identity")
rownames(tbl) <- c("RSS", "Coefficient", "Adjusted R^2", "p-value")
tbl <- as.table(tbl)
tbl
```

Now let's talk about what would be the most strongest factor that explains the support for trump. We can look at the coefficients to determine what would be strongest factor. From the above table, the coefficient for race is the largest among the four. From the table, we can see the coefficients for each of them: ideology (5.1480), race(16.3000), knowledge(14.3800), and american identity is (-6.726). The residual sum of squares also show that the regression model with race as the main predictor best fits with the data. It has the smallest residual sum of squares of 2701 compared to others which are: ideology (8362), knowledge(3743), and American identity(4989). Thus, based on the comparison of coefficients and residual sum of squares, we conclude that race best explains the support for trump. Being white increases the likely to support for trump by 16.3 degrees. 


Drawing a plot that displays the support for trump based on ethnicity
```{r}
table(anespi16$race, exclude = NULL)

anespi16$race1 <- NA
anespi16$race1[which(anespi16$race == 1)] <- "White"
anespi16$race1[which(anespi16$race == 2)] <- "Black"
anespi16$race1[which(anespi16$race == 3)] <- "Hispanic"
anespi16$race1[which(anespi16$race == 4)] <- "Asian"
anespi16$race1[which(anespi16$race >= 4)] <- "Other"

table(anespi16$race1, exclude = NULL)

require(ggplot2)
ggplot(anespi16, aes(x=age, y=fttrump)) + stat_smooth(method=lm, aes(fill = factor(race1), color= factor(race1)), se=F)
```

If we draw a plot that displays the support for trump based on ethnicity, we can see that whites, compared to other racial groups, are more likely to support for trump. The likelihood that whites will support trump is much higher than hispanics and other racial groups. Also, in the case of whites, hispanics, and other racial groups, older people are more likely to vote for trump. On the other hand, blacks are less likely support trump as they get older. So we can say that older people tend to support trump, but race affects the support for trump as well. 

Overall, by comaparing the coefficients and the sum of squared residuals of the four variables, we chose race to be the best explanation for trump support. We also find that age is positively correlated with trump support as whites and other ethnic groups (which composes 88% of the sample population) tend to support trump as they get older. However, in the case of blacks, age has a clear negative relationship with the likelihood of trump support. Based such results, we say to our friend that race is the most important factor that explains the support for trump. 


